---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  src: string;
  alt: string;
  caption?: string;
};

const { src, alt, caption } = Astro.props;
const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/images/**/**/**.{jpeg,jpg,png,gif,webp}");
---
<figure>
  <Image src={images[src]()} alt={alt} />
  <figcaption>{caption ? caption : alt}</figcaption>
</figure>

<style>
  figure {
    display: flex;
    flex-flow: column;
    justify-content: center;
    padding: 1.25rem 0.75rem;
    background-color: #fff;
    border: var(--border) var(--border-color);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    transition-property: all;

    figcaption {
      text-align: center;
      font-size: 1rem;
      margin-top: 0.25rem;
    }
    
    img { 
      aspect-ratio: 12/7;
      object-fit: cover;
      object-position: top;
      height: auto;
      border: var(--border) var(--border-color);
    }
  }

  :global([data-theme="dark"]) figure { background-color: #000; }
</style>